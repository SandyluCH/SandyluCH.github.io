## [how does the blockchain work](https://medium.com/@micheledaliessi/how-does-the-blockchain-work-98c8cd01d2ae)

比特币是数字货币，本身没有价值，他的价值只是因为我们同意交易商品和服务以换取我们控制的更高数量的货币。

为了跟踪比特币的数量，我们每个人都拥有区块链，使用分类账，这是一个跟踪所有比特币交易的数字文件。
![avatar](blockchainImg/blockchain_img1.png)

该分类账文件没有被存储在中央实体服务器，它通过私人计算机网络分布在世界各地，这些计算机即存储数据又执行计算。这些计算机中的每一个都代表区块链网络的“节点”，并具有分类账文件的副本。

如果大卫想要将比特币发送给sandra,他会向网络广播一条消息，称其账户中的比特币金额应该下降5比特币，而sandra账户的余额应该增加相同数量。网络中的每个节点都将接收消息并将请求的事务应用于其分类帐副本，从而更新账户余额。如图所示：
![avatar](blockchainImg/blockchain_img2.png)


分类账由一组连接的计算机维护而不是像银行这样的集中式实体维护的事实有几个含义：
- 在我们的银行系统中，我们只知道自己的交易和账户余额，在区块链上，每个人都可以大砍刀每个人的其他交易
- 比特币网络是分发的，如果出现问题，则无需致电服务台或任何人起诉
- 区块链系统的设计使得不需要信任，通过特殊的数学函数和代码获取安全性和可靠性

区块链可以定义为允许一组连接的计算机维护单个更新的安全分类账的系统。

为了能够在区块链上执行交易，您需要一个钱包，一个允许您存储和交换比特币的程序。由于只有您能够使用您的比特币，每个钱包都受到特殊加密方法的保护，该方法使用一对独特但连接的秘钥：私钥和公钥。

使用钱包的私钥加密交易请求时，您正在生成数字签名，区块链计算机使用该签名来仔细检查交易的来源和真实性。数字签名是一串文本，是您的交易请求和私钥组合的结果，因此不能用于其他交易。如果您更改了交易请求消息中的单个字符，则数字签名将发生变化，因此没有潜在的攻击者可以更改您的交易请求或更改您发送的比特币数量。

![avatar](blockchainImg/blockchain_img3.png)


要发送比特币，您需要证明您拥有特定钱包的私钥，因为您需要使用它来加密交易请求消息。请注意，由于您仅在加密后广播邮件，因此您永远不必透漏您的私钥。

区块链中的每个节点都保留了分类账的副本。区块链系统根本不跟踪账户余额，它只记录所请求的每一笔交易。实际上,分类账不跟踪余额，它只跟踪比特币网络内广播的每笔交易，如下图所示：
![avatar](blockchainImg/blockchain_img4.png)

要了解您的钱包余额，您需要分析并验证连接到钱包的整个网络上发生的所有交易。由于与先前交易的链接，执行此余额验证。为了向John发送10个比特币，Mary必须生成一个交易请求，其中包含指向总余额等于或超过10比特币的先前收到交易的链接。这些链接称为输入，网络中的节点将验证这些事物的总量是否等于或超过10比特币，并且这些输入尚未用完。实际上，每次在交易中引用输入时，这些输入在未来的任何交易中都被视为无效。这一切都在mary的钱包中自动执行，并由比特币网络节点进行双重检查，她只使用他的公钥向John的钱包发送10BTC交易。
![avatar](blockchainImg/blockchain_img5.png)

那么，系统如何信任输入事物并认为他们有效？它会检查与您用于通过每个输入作为输入的引用发送比特币的钱包相关的所有先前交易。为了简化和加速验证过程，网络节点保留了未花费的事务的特殊记录。由于这种安全检查，不可能花费两倍的比特币。


在比特币网络上执行交易的所有代码都是开源的，这意味着任何拥有笔记本电脑和互联网连接的人都可以运营交易。但是，如果用于广播事务请求消息的代码中存在错误，则相关的比特币将永久丢失。请记住，由于网络是分布式的，因此，没有客户支持呼叫，也没有任何人可以帮助您恢复丢失的交易或忘记的钱包密码。因此，如果您有兴趣在比特币网络上进行交易，建议使用开源和官方版本的比特币钱包软件（如比特币核心），并将钱包的密码或私钥存储在一个非常安全的存储库中。

任何人都可以通过匿名连接（即TOR网络或VPN网络）访问比特币网络，并提交或接收仅显示其公钥的交易。但是，如果有人反复使用相同的公钥，则可以将所有交易连接到同一所有者。比特币网络允许您生成任意数量的钱包，每个钱包都有自己的私钥和公钥。这允许您接收不能链接在一起的不同钱包的付款，除非您将所所有收到的比特币发送到一个钱包，否则无法知道您拥有所有这些钱包私钥。可能的比特币地址总数是2的160次方幂，这个大数字可以保护网络免受可能的攻击，同时允许任何人拥有钱包。

通过这种设置，仍然存在一个主要的安全漏洞，可以利用它来回收比特币。事务在网络中从节点传递到节点，因此两个事务到达每个节点的顺序可以不同。攻击者可以发送交易，等待对方运送产品，然后将反向交易发送回自己的账户。在这种情况下，一些节点可以在第一个事务之前接收第二个事务，因此当事务输入结果已经花费的时候，他们认为他们的第一个支付事务无效。按时间戳订购交易是不安全的因为它很容易被伪造。因此，没有办法判断交易是否发生在另一个交易之前，这就开辟了欺诈的可能性。

如果发生这种情况，网络节点之间就每个接收的交易顺序存在分歧。因此区块链系统被设计为使用节点协议来订购交易并防止上述欺诈。比特币网络通过将他们组合成称为b锁的组来命令事务，每个块包含一定数量的事务和前一个块的链接。这就是将一个快一个接一个地放在一起的原因。因此，块被组织成一个与时间相关的链，整个系统的名称就是区块链，如图所示:
![avatar](blockchainImg/blockchain_img6.png)

 